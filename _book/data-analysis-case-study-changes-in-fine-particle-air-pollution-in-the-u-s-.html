<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Exploratory Data Analysis with R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This book covers the essential exploratory techniques for summarizing data with R. These techniques are typically applied before formal modeling commences and can help inform the development of more complex statistical models. Exploratory techniques are also important for eliminating or sharpening potential hypotheses about the world that can be addressed by the data you have. We will cover in detail the plotting systems in R as well as some of the basic principles of constructing informative data graphics. We will also cover some of the common multivariate statistical techniques used to visualize high-dimensional data.">
  <meta name="generator" content="bookdown 0.1 and GitBook 2.6.7">

  <meta property="og:title" content="Exploratory Data Analysis with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/rdpeng/exdata/" />
  <meta property="og:image" content="https://bookdown.org/rdpeng/exdata/cover_sm.png" />
  <meta property="og:description" content="This book covers the essential exploratory techniques for summarizing data with R. These techniques are typically applied before formal modeling commences and can help inform the development of more complex statistical models. Exploratory techniques are also important for eliminating or sharpening potential hypotheses about the world that can be addressed by the data you have. We will cover in detail the plotting systems in R as well as some of the basic principles of constructing informative data graphics. We will also cover some of the common multivariate statistical techniques used to visualize high-dimensional data." />
  <meta name="github-repo" content="rdpeng/exdata" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Exploratory Data Analysis with R" />
  
  <meta name="twitter:description" content="This book covers the essential exploratory techniques for summarizing data with R. These techniques are typically applied before formal modeling commences and can help inform the development of more complex statistical models. Exploratory techniques are also important for eliminating or sharpening potential hypotheses about the world that can be addressed by the data you have. We will cover in detail the plotting systems in R as well as some of the basic principles of constructing informative data graphics. We will also cover some of the common multivariate statistical techniques used to visualize high-dimensional data." />
  <meta name="twitter:image" content="https://bookdown.org/rdpeng/exdata/cover_sm.png" />

<meta name="author" content="Roger D. Peng">

<meta name="date" content="2016-09-14">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="the-ggplot2-plotting-system-part-2.html">
<link rel="next" href="about-the-author.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Exploratory Data Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#stay-in-touch"><i class="fa fa-check"></i>Stay in Touch!</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting Started with R</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installation"><i class="fa fa-check"></i><b>2.1</b> Installation</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#getting-started-with-the-r-interface"><i class="fa fa-check"></i><b>2.2</b> Getting started with the R interface</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html"><i class="fa fa-check"></i><b>3</b> Managing Data Frames with the <code>dplyr</code> package</a><ul>
<li class="chapter" data-level="3.1" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#data-frames"><i class="fa fa-check"></i><b>3.1</b> Data Frames</a></li>
<li class="chapter" data-level="3.2" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#the-dplyr-package"><i class="fa fa-check"></i><b>3.2</b> The <code>dplyr</code> Package</a></li>
<li class="chapter" data-level="3.3" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#dplyr-grammar"><i class="fa fa-check"></i><b>3.3</b> <code>dplyr</code> Grammar</a><ul>
<li class="chapter" data-level="3.3.1" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#common-dplyr-function-properties"><i class="fa fa-check"></i><b>3.3.1</b> Common <code>dplyr</code> Function Properties</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#installing-the-dplyr-package"><i class="fa fa-check"></i><b>3.4</b> Installing the <code>dplyr</code> package</a></li>
<li class="chapter" data-level="3.5" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#select"><i class="fa fa-check"></i><b>3.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="3.6" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#filter"><i class="fa fa-check"></i><b>3.6</b> <code>filter()</code></a></li>
<li class="chapter" data-level="3.7" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#arrange"><i class="fa fa-check"></i><b>3.7</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="3.8" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#rename"><i class="fa fa-check"></i><b>3.8</b> <code>rename()</code></a></li>
<li class="chapter" data-level="3.9" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#mutate"><i class="fa fa-check"></i><b>3.9</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="3.10" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#group_by"><i class="fa fa-check"></i><b>3.10</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="3.11" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#section"><i class="fa fa-check"></i><b>3.11</b> <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.12" data-path="managing-data-frames-with-the-dplyr-package.html"><a href="managing-data-frames-with-the-dplyr-package.html#summary"><i class="fa fa-check"></i><b>3.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html"><i class="fa fa-check"></i><b>4</b> Exploratory Data Analysis Checklist</a><ul>
<li class="chapter" data-level="4.1" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html#formulate-your-question"><i class="fa fa-check"></i><b>4.1</b> Formulate your question</a></li>
<li class="chapter" data-level="4.2" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html#read-in-your-data"><i class="fa fa-check"></i><b>4.2</b> Read in your data</a></li>
<li class="chapter" data-level="4.3" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html#check-the-packaging"><i class="fa fa-check"></i><b>4.3</b> Check the packaging</a></li>
<li class="chapter" data-level="4.4" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html#run-str"><i class="fa fa-check"></i><b>4.4</b> Run <code>str()</code></a></li>
<li class="chapter" data-level="4.5" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html#look-at-the-top-and-the-bottom-of-your-data"><i class="fa fa-check"></i><b>4.5</b> Look at the top and the bottom of your data</a></li>
<li class="chapter" data-level="4.6" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html#check-your-ns"><i class="fa fa-check"></i><b>4.6</b> Check your “n”s</a></li>
<li class="chapter" data-level="4.7" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html#validate-with-at-least-one-external-data-source"><i class="fa fa-check"></i><b>4.7</b> Validate with at least one external data source</a></li>
<li class="chapter" data-level="4.8" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html#try-the-easy-solution-first"><i class="fa fa-check"></i><b>4.8</b> Try the easy solution first</a></li>
<li class="chapter" data-level="4.9" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html#challenge-your-solution"><i class="fa fa-check"></i><b>4.9</b> Challenge your solution</a></li>
<li class="chapter" data-level="4.10" data-path="exploratory-data-analysis-checklist.html"><a href="exploratory-data-analysis-checklist.html#follow-up-questions"><i class="fa fa-check"></i><b>4.10</b> Follow up questions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="principles-of-analytic-graphics.html"><a href="principles-of-analytic-graphics.html"><i class="fa fa-check"></i><b>5</b> Principles of Analytic Graphics</a><ul>
<li class="chapter" data-level="5.1" data-path="principles-of-analytic-graphics.html"><a href="principles-of-analytic-graphics.html#show-comparisons"><i class="fa fa-check"></i><b>5.1</b> Show comparisons</a></li>
<li class="chapter" data-level="5.2" data-path="principles-of-analytic-graphics.html"><a href="principles-of-analytic-graphics.html#show-causality-mechanism-explanation-systematic-structure"><i class="fa fa-check"></i><b>5.2</b> Show causality, mechanism, explanation, systematic structure</a></li>
<li class="chapter" data-level="5.3" data-path="principles-of-analytic-graphics.html"><a href="principles-of-analytic-graphics.html#show-multivariate-data"><i class="fa fa-check"></i><b>5.3</b> Show multivariate data</a></li>
<li class="chapter" data-level="5.4" data-path="principles-of-analytic-graphics.html"><a href="principles-of-analytic-graphics.html#integrate-evidence"><i class="fa fa-check"></i><b>5.4</b> Integrate evidence</a></li>
<li class="chapter" data-level="5.5" data-path="principles-of-analytic-graphics.html"><a href="principles-of-analytic-graphics.html#describe-and-document-the-evidence"><i class="fa fa-check"></i><b>5.5</b> Describe and document the evidence</a></li>
<li class="chapter" data-level="5.6" data-path="principles-of-analytic-graphics.html"><a href="principles-of-analytic-graphics.html#content-content-content"><i class="fa fa-check"></i><b>5.6</b> Content, Content, Content</a></li>
<li class="chapter" data-level="5.7" data-path="principles-of-analytic-graphics.html"><a href="principles-of-analytic-graphics.html#references"><i class="fa fa-check"></i><b>5.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html"><i class="fa fa-check"></i><b>6</b> Exploratory Graphs</a><ul>
<li class="chapter" data-level="6.1" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#characteristics-of-exploratory-graphs"><i class="fa fa-check"></i><b>6.1</b> Characteristics of exploratory graphs</a></li>
<li class="chapter" data-level="6.2" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#air-pollution-in-the-united-states"><i class="fa fa-check"></i><b>6.2</b> Air Pollution in the United States</a></li>
<li class="chapter" data-level="6.3" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#getting-the-data"><i class="fa fa-check"></i><b>6.3</b> Getting the Data</a></li>
<li class="chapter" data-level="6.4" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#simple-summaries-one-dimension"><i class="fa fa-check"></i><b>6.4</b> Simple Summaries: One Dimension</a></li>
<li class="chapter" data-level="6.5" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#five-number-summary"><i class="fa fa-check"></i><b>6.5</b> Five Number Summary</a></li>
<li class="chapter" data-level="6.6" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#boxplot"><i class="fa fa-check"></i><b>6.6</b> Boxplot</a></li>
<li class="chapter" data-level="6.7" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#histogram"><i class="fa fa-check"></i><b>6.7</b> Histogram</a></li>
<li class="chapter" data-level="6.8" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#overlaying-features"><i class="fa fa-check"></i><b>6.8</b> Overlaying Features</a></li>
<li class="chapter" data-level="6.9" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#barplot"><i class="fa fa-check"></i><b>6.9</b> Barplot</a></li>
<li class="chapter" data-level="6.10" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#simple-summaries-two-dimensions-and-beyond"><i class="fa fa-check"></i><b>6.10</b> Simple Summaries: Two Dimensions and Beyond</a></li>
<li class="chapter" data-level="6.11" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#multiple-boxplots"><i class="fa fa-check"></i><b>6.11</b> Multiple Boxplots</a></li>
<li class="chapter" data-level="6.12" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#multiple-histograms"><i class="fa fa-check"></i><b>6.12</b> Multiple Histograms</a></li>
<li class="chapter" data-level="6.13" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#scatterplots"><i class="fa fa-check"></i><b>6.13</b> Scatterplots</a></li>
<li class="chapter" data-level="6.14" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#scatterplot---using-color"><i class="fa fa-check"></i><b>6.14</b> Scatterplot - Using Color</a></li>
<li class="chapter" data-level="6.15" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#multiple-scatterplots"><i class="fa fa-check"></i><b>6.15</b> Multiple Scatterplots</a></li>
<li class="chapter" data-level="6.16" data-path="exploratory-graphs.html"><a href="exploratory-graphs.html#summary-1"><i class="fa fa-check"></i><b>6.16</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="plotting-systems.html"><a href="plotting-systems.html"><i class="fa fa-check"></i><b>7</b> Plotting Systems</a><ul>
<li class="chapter" data-level="7.1" data-path="plotting-systems.html"><a href="plotting-systems.html#the-base-plotting-system"><i class="fa fa-check"></i><b>7.1</b> The Base Plotting System</a></li>
<li class="chapter" data-level="7.2" data-path="plotting-systems.html"><a href="plotting-systems.html#the-lattice-system"><i class="fa fa-check"></i><b>7.2</b> The Lattice System</a></li>
<li class="chapter" data-level="7.3" data-path="plotting-systems.html"><a href="plotting-systems.html#the-ggplot2-system"><i class="fa fa-check"></i><b>7.3</b> The ggplot2 System</a></li>
<li class="chapter" data-level="7.4" data-path="plotting-systems.html"><a href="plotting-systems.html#references-1"><i class="fa fa-check"></i><b>7.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="graphics-devices.html"><a href="graphics-devices.html"><i class="fa fa-check"></i><b>8</b> Graphics Devices</a><ul>
<li class="chapter" data-level="8.1" data-path="graphics-devices.html"><a href="graphics-devices.html#the-process-of-making-a-plot"><i class="fa fa-check"></i><b>8.1</b> The Process of Making a Plot</a></li>
<li class="chapter" data-level="8.2" data-path="graphics-devices.html"><a href="graphics-devices.html#how-does-a-plot-get-created"><i class="fa fa-check"></i><b>8.2</b> How Does a Plot Get Created?</a></li>
<li class="chapter" data-level="8.3" data-path="graphics-devices.html"><a href="graphics-devices.html#graphics-file-devices"><i class="fa fa-check"></i><b>8.3</b> Graphics File Devices</a></li>
<li class="chapter" data-level="8.4" data-path="graphics-devices.html"><a href="graphics-devices.html#multiple-open-graphics-devices"><i class="fa fa-check"></i><b>8.4</b> Multiple Open Graphics Devices</a></li>
<li class="chapter" data-level="8.5" data-path="graphics-devices.html"><a href="graphics-devices.html#copying-plots"><i class="fa fa-check"></i><b>8.5</b> Copying Plots</a></li>
<li class="chapter" data-level="8.6" data-path="graphics-devices.html"><a href="graphics-devices.html#summary-2"><i class="fa fa-check"></i><b>8.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html"><i class="fa fa-check"></i><b>9</b> The Base Plotting System</a><ul>
<li class="chapter" data-level="9.1" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html#base-graphics"><i class="fa fa-check"></i><b>9.1</b> Base Graphics</a></li>
<li class="chapter" data-level="9.2" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html#simple-base-graphics"><i class="fa fa-check"></i><b>9.2</b> Simple Base Graphics</a><ul>
<li class="chapter" data-level="9.2.1" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html#histogram-1"><i class="fa fa-check"></i><b>9.2.1</b> Histogram</a></li>
<li class="chapter" data-level="9.2.2" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html#boxplot-1"><i class="fa fa-check"></i><b>9.2.2</b> Boxplot</a></li>
<li class="chapter" data-level="9.2.3" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html#scatterplot"><i class="fa fa-check"></i><b>9.2.3</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html#some-important-base-graphics-parameters"><i class="fa fa-check"></i><b>9.3</b> Some Important Base Graphics Parameters</a></li>
<li class="chapter" data-level="9.4" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html#base-plotting-functions"><i class="fa fa-check"></i><b>9.4</b> Base Plotting Functions</a></li>
<li class="chapter" data-level="9.5" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html#base-plot-with-regression-line"><i class="fa fa-check"></i><b>9.5</b> Base Plot with Regression Line</a></li>
<li class="chapter" data-level="9.6" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html#multiple-base-plots"><i class="fa fa-check"></i><b>9.6</b> Multiple Base Plots</a></li>
<li class="chapter" data-level="9.7" data-path="the-base-plotting-system-1.html"><a href="the-base-plotting-system-1.html#summary-3"><i class="fa fa-check"></i><b>9.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html"><i class="fa fa-check"></i><b>10</b> Plotting and Color in R</a><ul>
<li class="chapter" data-level="10.1" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html#colors-1-2-and-3"><i class="fa fa-check"></i><b>10.1</b> Colors 1, 2, and 3</a></li>
<li class="chapter" data-level="10.2" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html#connecting-colors-with-data"><i class="fa fa-check"></i><b>10.2</b> Connecting colors with data</a></li>
<li class="chapter" data-level="10.3" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html#color-utilities-in-r"><i class="fa fa-check"></i><b>10.3</b> Color Utilities in R</a></li>
<li class="chapter" data-level="10.4" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html#colorramp"><i class="fa fa-check"></i><b>10.4</b> <code>colorRamp()</code></a></li>
<li class="chapter" data-level="10.5" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html#colorramppalette"><i class="fa fa-check"></i><b>10.5</b> <code>colorRampPalette()</code></a></li>
<li class="chapter" data-level="10.6" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html#rcolorbrewer-package"><i class="fa fa-check"></i><b>10.6</b> RColorBrewer Package</a></li>
<li class="chapter" data-level="10.7" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html#using-the-rcolorbrewer-palettes"><i class="fa fa-check"></i><b>10.7</b> Using the RColorBrewer palettes</a></li>
<li class="chapter" data-level="10.8" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html#the-smoothscatter-function"><i class="fa fa-check"></i><b>10.8</b> The <code>smoothScatter()</code> function</a></li>
<li class="chapter" data-level="10.9" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html#adding-transparency"><i class="fa fa-check"></i><b>10.9</b> Adding transparency</a></li>
<li class="chapter" data-level="10.10" data-path="plotting-and-color-in-r.html"><a href="plotting-and-color-in-r.html#summary-4"><i class="fa fa-check"></i><b>10.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html"><i class="fa fa-check"></i><b>11</b> Hierarchical Clustering</a><ul>
<li class="chapter" data-level="11.1" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#hierarchical-clustering-1"><i class="fa fa-check"></i><b>11.1</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="11.2" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#how-do-we-define-close"><i class="fa fa-check"></i><b>11.2</b> How do we define close?</a></li>
<li class="chapter" data-level="11.3" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#example-euclidean-distance"><i class="fa fa-check"></i><b>11.3</b> Example: Euclidean distance</a></li>
<li class="chapter" data-level="11.4" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#example-manhattan-distance"><i class="fa fa-check"></i><b>11.4</b> Example: Manhattan distance</a></li>
<li class="chapter" data-level="11.5" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#example-hierarchical-clustering"><i class="fa fa-check"></i><b>11.5</b> Example: Hierarchical clustering</a></li>
<li class="chapter" data-level="11.6" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#prettier-dendrograms"><i class="fa fa-check"></i><b>11.6</b> Prettier dendrograms</a></li>
<li class="chapter" data-level="11.7" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#merging-points-complete"><i class="fa fa-check"></i><b>11.7</b> Merging points: Complete</a></li>
<li class="chapter" data-level="11.8" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#merging-points-average"><i class="fa fa-check"></i><b>11.8</b> Merging points: Average</a></li>
<li class="chapter" data-level="11.9" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#using-the-heatmap-function"><i class="fa fa-check"></i><b>11.9</b> Using the <code>heatmap()</code> function</a></li>
<li class="chapter" data-level="11.10" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#notes-and-further-resources"><i class="fa fa-check"></i><b>11.10</b> Notes and further resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="k-means-clustering.html"><a href="k-means-clustering.html"><i class="fa fa-check"></i><b>12</b> K-Means Clustering</a><ul>
<li class="chapter" data-level="12.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html#illustrating-the-k-means-algorithm"><i class="fa fa-check"></i><b>12.1</b> Illustrating the K-means algorithm</a></li>
<li class="chapter" data-level="12.2" data-path="k-means-clustering.html"><a href="k-means-clustering.html#stopping-the-algorithm"><i class="fa fa-check"></i><b>12.2</b> Stopping the algorithm</a></li>
<li class="chapter" data-level="12.3" data-path="k-means-clustering.html"><a href="k-means-clustering.html#using-the-kmeans-function"><i class="fa fa-check"></i><b>12.3</b> Using the <code>kmeans()</code> function</a></li>
<li class="chapter" data-level="12.4" data-path="k-means-clustering.html"><a href="k-means-clustering.html#building-heatmaps-from-k-means-solutions"><i class="fa fa-check"></i><b>12.4</b> Building heatmaps from K-means solutions</a></li>
<li class="chapter" data-level="12.5" data-path="k-means-clustering.html"><a href="k-means-clustering.html#notes-and-further-resources-1"><i class="fa fa-check"></i><b>12.5</b> Notes and further resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="dimension-reduction.html"><a href="dimension-reduction.html"><i class="fa fa-check"></i><b>13</b> Dimension Reduction</a><ul>
<li class="chapter" data-level="13.1" data-path="dimension-reduction.html"><a href="dimension-reduction.html#matrix-data"><i class="fa fa-check"></i><b>13.1</b> Matrix data</a></li>
<li class="chapter" data-level="13.2" data-path="dimension-reduction.html"><a href="dimension-reduction.html#patterns-in-rows-and-columns"><i class="fa fa-check"></i><b>13.2</b> Patterns in rows and columns</a></li>
<li class="chapter" data-level="13.3" data-path="dimension-reduction.html"><a href="dimension-reduction.html#related-problem"><i class="fa fa-check"></i><b>13.3</b> Related problem</a></li>
<li class="chapter" data-level="13.4" data-path="dimension-reduction.html"><a href="dimension-reduction.html#svd-and-pca"><i class="fa fa-check"></i><b>13.4</b> SVD and PCA</a></li>
<li class="chapter" data-level="13.5" data-path="dimension-reduction.html"><a href="dimension-reduction.html#unpacking-the-svd-u-and-v"><i class="fa fa-check"></i><b>13.5</b> Unpacking the SVD: <em>u</em> and <em>v</em></a></li>
<li class="chapter" data-level="13.6" data-path="dimension-reduction.html"><a href="dimension-reduction.html#svd-for-data-compression"><i class="fa fa-check"></i><b>13.6</b> SVD for data compression</a></li>
<li class="chapter" data-level="13.7" data-path="dimension-reduction.html"><a href="dimension-reduction.html#components-of-the-svd---variance-explained"><i class="fa fa-check"></i><b>13.7</b> Components of the SVD - Variance explained</a></li>
<li class="chapter" data-level="13.8" data-path="dimension-reduction.html"><a href="dimension-reduction.html#relationship-to-principal-components"><i class="fa fa-check"></i><b>13.8</b> Relationship to principal components</a></li>
<li class="chapter" data-level="13.9" data-path="dimension-reduction.html"><a href="dimension-reduction.html#what-if-we-add-a-second-pattern"><i class="fa fa-check"></i><b>13.9</b> What if we add a second pattern?</a></li>
<li class="chapter" data-level="13.10" data-path="dimension-reduction.html"><a href="dimension-reduction.html#dealing-with-missing-values"><i class="fa fa-check"></i><b>13.10</b> Dealing with missing values</a></li>
<li class="chapter" data-level="13.11" data-path="dimension-reduction.html"><a href="dimension-reduction.html#example-face-data"><i class="fa fa-check"></i><b>13.11</b> Example: Face data</a></li>
<li class="chapter" data-level="13.12" data-path="dimension-reduction.html"><a href="dimension-reduction.html#notes-and-further-resources-2"><i class="fa fa-check"></i><b>13.12</b> Notes and further resources</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="the-ggplot2-plotting-system-part-1.html"><a href="the-ggplot2-plotting-system-part-1.html"><i class="fa fa-check"></i><b>14</b> The ggplot2 Plotting System: Part 1</a><ul>
<li class="chapter" data-level="14.1" data-path="the-ggplot2-plotting-system-part-1.html"><a href="the-ggplot2-plotting-system-part-1.html#the-basics-qplot"><i class="fa fa-check"></i><b>14.1</b> The Basics: <code>qplot()</code></a></li>
<li class="chapter" data-level="14.2" data-path="the-ggplot2-plotting-system-part-1.html"><a href="the-ggplot2-plotting-system-part-1.html#before-you-start-label-your-data"><i class="fa fa-check"></i><b>14.2</b> Before You Start: Label Your Data</a></li>
<li class="chapter" data-level="14.3" data-path="the-ggplot2-plotting-system-part-1.html"><a href="the-ggplot2-plotting-system-part-1.html#ggplot2-hello-world"><i class="fa fa-check"></i><b>14.3</b> ggplot2 “Hello, world!”</a></li>
<li class="chapter" data-level="14.4" data-path="the-ggplot2-plotting-system-part-1.html"><a href="the-ggplot2-plotting-system-part-1.html#modifying-aesthetics"><i class="fa fa-check"></i><b>14.4</b> Modifying aesthetics</a></li>
<li class="chapter" data-level="14.5" data-path="the-ggplot2-plotting-system-part-1.html"><a href="the-ggplot2-plotting-system-part-1.html#adding-a-geom"><i class="fa fa-check"></i><b>14.5</b> Adding a geom</a></li>
<li class="chapter" data-level="14.6" data-path="the-ggplot2-plotting-system-part-1.html"><a href="the-ggplot2-plotting-system-part-1.html#histograms"><i class="fa fa-check"></i><b>14.6</b> Histograms</a></li>
<li class="chapter" data-level="14.7" data-path="the-ggplot2-plotting-system-part-1.html"><a href="the-ggplot2-plotting-system-part-1.html#facets"><i class="fa fa-check"></i><b>14.7</b> Facets</a></li>
<li class="chapter" data-level="14.8" data-path="the-ggplot2-plotting-system-part-1.html"><a href="the-ggplot2-plotting-system-part-1.html#case-study-maacs-cohort"><i class="fa fa-check"></i><b>14.8</b> Case Study: MAACS Cohort</a></li>
<li class="chapter" data-level="14.9" data-path="the-ggplot2-plotting-system-part-1.html"><a href="the-ggplot2-plotting-system-part-1.html#summary-of-qplot"><i class="fa fa-check"></i><b>14.9</b> Summary of qplot()</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html"><i class="fa fa-check"></i><b>15</b> The ggplot2 Plotting System: Part 2</a><ul>
<li class="chapter" data-level="15.1" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#basic-components-of-a-ggplot2-plot"><i class="fa fa-check"></i><b>15.1</b> Basic Components of a ggplot2 Plot</a></li>
<li class="chapter" data-level="15.2" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#example-bmi-pm2.5-asthma"><i class="fa fa-check"></i><b>15.2</b> Example: BMI, PM2.5, Asthma</a></li>
<li class="chapter" data-level="15.3" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#building-up-in-layers"><i class="fa fa-check"></i><b>15.3</b> Building Up in Layers</a></li>
<li class="chapter" data-level="15.4" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#first-plot-with-point-layer"><i class="fa fa-check"></i><b>15.4</b> First Plot with Point Layer</a></li>
<li class="chapter" data-level="15.5" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#adding-more-layers-smooth"><i class="fa fa-check"></i><b>15.5</b> Adding More Layers: Smooth</a></li>
<li class="chapter" data-level="15.6" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#adding-more-layers-facets"><i class="fa fa-check"></i><b>15.6</b> Adding More Layers: Facets</a></li>
<li class="chapter" data-level="15.7" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#modifying-geom-properties"><i class="fa fa-check"></i><b>15.7</b> Modifying Geom Properties</a></li>
<li class="chapter" data-level="15.8" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#modifying-labels"><i class="fa fa-check"></i><b>15.8</b> Modifying Labels</a></li>
<li class="chapter" data-level="15.9" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#customizing-the-smooth"><i class="fa fa-check"></i><b>15.9</b> Customizing the Smooth</a></li>
<li class="chapter" data-level="15.10" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#changing-the-theme"><i class="fa fa-check"></i><b>15.10</b> Changing the Theme</a></li>
<li class="chapter" data-level="15.11" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#more-complex-example"><i class="fa fa-check"></i><b>15.11</b> More Complex Example</a></li>
<li class="chapter" data-level="15.12" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#a-quick-aside-about-axis-limits"><i class="fa fa-check"></i><b>15.12</b> A Quick Aside about Axis Limits</a></li>
<li class="chapter" data-level="15.13" data-path="the-ggplot2-plotting-system-part-2.html"><a href="the-ggplot2-plotting-system-part-2.html#resources"><i class="fa fa-check"></i><b>15.13</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html"><a href="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html"><i class="fa fa-check"></i><b>16</b> Data Analysis Case Study: Changes in Fine Particle Air Pollution in the U.S.</a><ul>
<li class="chapter" data-level="16.1" data-path="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html"><a href="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html#synopsis"><i class="fa fa-check"></i><b>16.1</b> Synopsis</a></li>
<li class="chapter" data-level="16.2" data-path="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html"><a href="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html#loading-and-processing-the-raw-data"><i class="fa fa-check"></i><b>16.2</b> Loading and Processing the Raw Data</a><ul>
<li class="chapter" data-level="16.2.1" data-path="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html"><a href="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html#reading-in-the-1999-data"><i class="fa fa-check"></i><b>16.2.1</b> Reading in the 1999 data</a></li>
<li class="chapter" data-level="16.2.2" data-path="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html"><a href="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html#reading-in-the-2012-data"><i class="fa fa-check"></i><b>16.2.2</b> Reading in the 2012 data</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html"><a href="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html#results"><i class="fa fa-check"></i><b>16.3</b> Results</a><ul>
<li class="chapter" data-level="16.3.1" data-path="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html"><a href="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html#entire-u.s.-analysis"><i class="fa fa-check"></i><b>16.3.1</b> Entire U.S. analysis</a></li>
<li class="chapter" data-level="16.3.2" data-path="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html"><a href="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html#changes-in-pm-levels-at-an-individual-monitor"><i class="fa fa-check"></i><b>16.3.2</b> Changes in PM levels at an individual monitor</a></li>
<li class="chapter" data-level="16.3.3" data-path="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html"><a href="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u-s-.html#changes-in-state-wide-pm-levels"><i class="fa fa-check"></i><b>16.3.3</b> Changes in state-wide PM levels</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i><b>17</b> About the Author</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploratory Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-analysis-case-study-changes-in-fine-particle-air-pollution-in-the-u.s." class="section level1">
<h1><span class="header-section-number">16</span> Data Analysis Case Study: Changes in Fine Particle Air Pollution in the U.S.</h1>
<p>This chapter presents an example data analysis looking at changes in fine particulate matter (PM) air pollution in the United States using the Environmental Protection Agencies freely available national monitoring data. The purpose of the chapter is to just show how the various tools that we have covered in this book can be used to read, manipulate, and summarize data so that you can develop statistical evidence for relevant real-world questions.</p>
<p><a href="https://youtu.be/VE-6bQvyfTQ">Watch a video of this chapter</a>. Note that this video differs slightly from this chapter in the code that is implemented. In particular, the video version focuses on using base graphics plots. However, the general analysis is the same.</p>
<div id="synopsis" class="section level2">
<h2><span class="header-section-number">16.1</span> Synopsis</h2>
<p>In this chapter we aim to describe the changes in fine particle (PM2.5) outdoor air pollution in the United States between the years 1999 and 2012. Our overall hypothesis is that out door PM2.5 has decreased on average across the U.S. due to nationwide regulatory requirements arising from the Clean Air Act. To investigate this hypothesis, we obtained PM2.5 data from the U.S. Environmental Protection Agency which is collected from monitors sited across the U.S. We specifically obtained data for the years 1999 and 2012 (the most recent complete year available). From these data, we found that, on average across the U.S., levels of PM2.5 have decreased between 1999 and 2012. At one individual monitor, we found that levels have decreased and that the variability of PM2.5 has decreased. Most individual states also experienced decreases in PM2.5, although some states saw increases.</p>
</div>
<div id="loading-and-processing-the-raw-data" class="section level2">
<h2><span class="header-section-number">16.2</span> Loading and Processing the Raw Data</h2>
<p>From the <a href="http://www.epa.gov/ttn/airs/airsaqs/detaildata/downloadaqsdata.htm">EPA Air Quality System</a> we obtained data on fine particulate matter air pollution (PM2.5) that is monitored across the U.S. as part of the nationwide PM monitoring network. We obtained the files for the years 1999 and 2012.</p>
<div id="reading-in-the-1999-data" class="section level3">
<h3><span class="header-section-number">16.2.1</span> Reading in the 1999 data</h3>
<p>We first read in the 1999 data from the raw text file included in the zip archive. The data is a delimited file were fields are delimited with the <code>|</code> character adn missing values are coded as blank fields. We skip some commented lines in the beginning of the file and initially we do not read the header data.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(readr)
&gt;<span class="st"> </span>pm0 &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;data/RD_501_88101_1999-0.txt&quot;</span>, 
+<span class="st">                   </span><span class="dt">delim =</span> <span class="st">&quot;|&quot;</span>,
+<span class="st">                   </span><span class="dt">comment =</span> <span class="st">&quot;#&quot;</span>, 
+<span class="st">                   </span><span class="dt">col_names =</span> <span class="ot">FALSE</span>, 
+<span class="st">                   </span><span class="dt">na =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<p>After reading in the 1999 we check the first few rows (there are 117,421) rows in this dataset.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">dim</span>(pm0)
[<span class="dv">1</span>] <span class="dv">117421</span>     <span class="dv">28</span>
&gt;<span class="st"> </span><span class="kw">head</span>(pm0[, <span class="dv">1</span>:<span class="dv">13</span>])
<span class="co"># A tibble: 6 × 13</span>
     X1    X2    X3    X4    X5    X6    X7    X8    X9   X10      X11
  &lt;chr&gt;<span class="st"> </span><span class="er">&lt;</span>chr&gt;<span class="st"> </span><span class="er">&lt;</span>chr&gt;<span class="st"> </span><span class="er">&lt;</span>chr&gt;<span class="st"> </span><span class="er">&lt;</span>chr&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st">    </span><span class="er">&lt;</span>int&gt;
<span class="dv">1</span>    RD     I    <span class="dv">01</span>   <span class="dv">027</span>  <span class="dv">0001</span> <span class="dv">88101</span>     <span class="dv">1</span>     <span class="dv">7</span>   <span class="dv">105</span>   <span class="dv">120</span> <span class="dv">19990103</span>
<span class="dv">2</span>    RD     I    <span class="dv">01</span>   <span class="dv">027</span>  <span class="dv">0001</span> <span class="dv">88101</span>     <span class="dv">1</span>     <span class="dv">7</span>   <span class="dv">105</span>   <span class="dv">120</span> <span class="dv">19990106</span>
<span class="dv">3</span>    RD     I    <span class="dv">01</span>   <span class="dv">027</span>  <span class="dv">0001</span> <span class="dv">88101</span>     <span class="dv">1</span>     <span class="dv">7</span>   <span class="dv">105</span>   <span class="dv">120</span> <span class="dv">19990109</span>
<span class="dv">4</span>    RD     I    <span class="dv">01</span>   <span class="dv">027</span>  <span class="dv">0001</span> <span class="dv">88101</span>     <span class="dv">1</span>     <span class="dv">7</span>   <span class="dv">105</span>   <span class="dv">120</span> <span class="dv">19990112</span>
<span class="dv">5</span>    RD     I    <span class="dv">01</span>   <span class="dv">027</span>  <span class="dv">0001</span> <span class="dv">88101</span>     <span class="dv">1</span>     <span class="dv">7</span>   <span class="dv">105</span>   <span class="dv">120</span> <span class="dv">19990115</span>
<span class="dv">6</span>    RD     I    <span class="dv">01</span>   <span class="dv">027</span>  <span class="dv">0001</span> <span class="dv">88101</span>     <span class="dv">1</span>     <span class="dv">7</span>   <span class="dv">105</span>   <span class="dv">120</span> <span class="dv">19990118</span>
<span class="co"># ... with 2 more variables: X12 &lt;time&gt;, X13 &lt;dbl&gt;</span></code></pre>
<p>We then attach the column headers to the dataset and make sure that they are properly formated for R data frames.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>cnames &lt;-<span class="st"> </span><span class="kw">readLines</span>(<span class="st">&quot;data/RD_501_88101_1999-0.txt&quot;</span>, <span class="dv">1</span>)
&gt;<span class="st"> </span>cnames &lt;-<span class="st"> </span><span class="kw">strsplit</span>(cnames, <span class="st">&quot;|&quot;</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)
&gt;<span class="st"> </span>## Ensure names are properly formatted
<span class="er">&gt;</span><span class="st"> </span><span class="kw">names</span>(pm0) &lt;-<span class="st"> </span><span class="kw">make.names</span>(cnames[[<span class="dv">1</span>]])  
&gt;<span class="st"> </span><span class="kw">head</span>(pm0[, <span class="dv">1</span>:<span class="dv">13</span>])
<span class="co"># A tibble: 6 × 13</span>
  X..RD Action.Code State.Code County.Code Site.ID Parameter   POC
  &lt;chr&gt;<span class="st">       </span><span class="er">&lt;</span>chr&gt;<span class="st">      </span><span class="er">&lt;</span>chr&gt;<span class="st">       </span><span class="er">&lt;</span>chr&gt;<span class="st">   </span><span class="er">&lt;</span>chr&gt;<span class="st">     </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;
<span class="dv">1</span>    RD           I         <span class="dv">01</span>         <span class="dv">027</span>    <span class="dv">0001</span>     <span class="dv">88101</span>     <span class="dv">1</span>
<span class="dv">2</span>    RD           I         <span class="dv">01</span>         <span class="dv">027</span>    <span class="dv">0001</span>     <span class="dv">88101</span>     <span class="dv">1</span>
<span class="dv">3</span>    RD           I         <span class="dv">01</span>         <span class="dv">027</span>    <span class="dv">0001</span>     <span class="dv">88101</span>     <span class="dv">1</span>
<span class="dv">4</span>    RD           I         <span class="dv">01</span>         <span class="dv">027</span>    <span class="dv">0001</span>     <span class="dv">88101</span>     <span class="dv">1</span>
<span class="dv">5</span>    RD           I         <span class="dv">01</span>         <span class="dv">027</span>    <span class="dv">0001</span>     <span class="dv">88101</span>     <span class="dv">1</span>
<span class="dv">6</span>    RD           I         <span class="dv">01</span>         <span class="dv">027</span>    <span class="dv">0001</span>     <span class="dv">88101</span>     <span class="dv">1</span>
<span class="co"># ... with 6 more variables: Sample.Duration &lt;int&gt;, Unit &lt;int&gt;,</span>
<span class="co">#   Method &lt;int&gt;, Date &lt;int&gt;, Start.Time &lt;time&gt;, Sample.Value &lt;dbl&gt;</span></code></pre>
<p>The column we are interested in is the <code>Sample.Value</code> column which contains the PM2.5 measurements. Here we extract that column and print a brief summary.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>x0 &lt;-<span class="st"> </span>pm0$Sample.Value
&gt;<span class="st"> </span><span class="kw">summary</span>(x0)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA<span class="st">&#39;s </span>
<span class="st">   0.00    7.20   11.50   13.74   17.90  157.10   13217 </span></code></pre>
<p>Missing values are a common problem with environmental data and so we check to se what proportion of the observations are missing (i.e. coded as <code>NA</code>).</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>## Are missing values important here?
<span class="er">&gt;</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">is.na</span>(x0))
[<span class="dv">1</span>] <span class="fl">0.1125608</span></code></pre>
<p>Because the proportion of missing values is relatively low (0.1125608), we choose to ignore missing values for now.</p>
</div>
<div id="reading-in-the-2012-data" class="section level3">
<h3><span class="header-section-number">16.2.2</span> Reading in the 2012 data</h3>
<p>We then read in the 2012 data in the same manner in which we read the 1999 data (the data files are in the same format).</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>pm1 &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;data/RD_501_88101_2012-0.txt&quot;</span>, 
+<span class="st">                   </span><span class="dt">comment =</span> <span class="st">&quot;#&quot;</span>, 
+<span class="st">                   </span><span class="dt">col_names =</span> <span class="ot">FALSE</span>, 
+<span class="st">                   </span><span class="dt">delim =</span> <span class="st">&quot;|&quot;</span>, 
+<span class="st">                   </span><span class="dt">na =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<p>We also set the column names (they are the same as the 1999 dataset) and extract the <code>Sample.Value</code> column from this dataset.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">names</span>(pm1) &lt;-<span class="st"> </span><span class="kw">make.names</span>(cnames[[<span class="dv">1</span>]])</code></pre>
<p>Since we will be comparing the two years of data, it makes sense to combine them into a single data frame</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(dplyr)
&gt;<span class="st"> </span>pm &lt;-<span class="st"> </span><span class="kw">rbind</span>(pm0, pm1)</code></pre>
<p>and create a factor variable indicating which year the data comes from. We also rename the <code>Sample.Value</code> variable to a more sensible <code>PM</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>pm &lt;-<span class="st"> </span><span class="kw">mutate</span>(pm, <span class="dt">year =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1999</span>, <span class="dv">2012</span>), <span class="kw">c</span>(<span class="kw">nrow</span>(pm0), <span class="kw">nrow</span>(pm1))))) %&gt;%
+<span class="st">         </span><span class="kw">rename</span>(<span class="dt">PM =</span> Sample.Value)</code></pre>
</div>
</div>
<div id="results" class="section level2">
<h2><span class="header-section-number">16.3</span> Results</h2>
<div id="entire-u.s.-analysis" class="section level3">
<h3><span class="header-section-number">16.3.1</span> Entire U.S. analysis</h3>
<p>In order to show aggregate changes in PM across the entire monitoring network, we can make boxplots of all monitor values in 1999 and 2012. Here, we take the log of the PM values to adjust for the skew in the data.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(ggplot2)
&gt;<span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>## Take a random sample because it&#39;s faster
<span class="er">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">2015</span>)
&gt;<span class="st"> </span>idx &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(pm), <span class="dv">1000</span>)
&gt;<span class="st"> </span><span class="kw">qplot</span>(year, <span class="kw">log2</span>(PM), <span class="dt">data =</span> pm[idx, ], <span class="dt">geom =</span> <span class="st">&quot;boxplot&quot;</span>)</code></pre>
<div class="figure"><span id="fig:boxplotlogvalues"></span>
<img src="images/example-boxplotlogvalues-1.png" alt="Boxplot of PM values in 1999 and 2012" width="672" />
<p class="caption">
Figure 16.1: Boxplot of PM values in 1999 and 2012
</p>
</div>
<p>From the raw boxplot, it seems that on average, the levels of PM in 2012 are lower than they were in 1999. Interestingly, there also appears to be much greater variation in PM in 2012 than there was in 1999.</p>
<p>We can make some summaries of the two year’s worth data to get at actual numbers.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">with</span>(pm, <span class="kw">tapply</span>(PM, year, summary))
$<span class="st">`</span><span class="dt">1999</span><span class="st">`</span>
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA<span class="st">&#39;s </span>
<span class="st">   0.00    7.20   11.50   13.74   17.90  157.10   13217 </span>

<span class="st">$`2012`</span>
<span class="st">   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;</span>s 
 -<span class="fl">10.00</span>    <span class="fl">4.00</span>    <span class="fl">7.63</span>    <span class="fl">9.14</span>   <span class="fl">12.00</span>  <span class="fl">909.00</span>   <span class="dv">73133</span> </code></pre>
<p>Interestingly, from the summary of 2012 it appears there are some negative values of PM, which in general should not occur. We can investigate that somewhat to see if there is anything we should worry about.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">filter</span>(pm, year ==<span class="st"> &quot;2012&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">summarize</span>(<span class="dt">negative =</span> <span class="kw">mean</span>(PM &lt;<span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
<span class="co"># A tibble: 1 × 1</span>
   negative
      &lt;dbl&gt;
<span class="dv">1</span> <span class="fl">0.0215034</span></code></pre>
<p>There is a relatively small proportion of values that are negative, which is perhaps reassuring. In order to investigate this a step further we can extract the date of each measurement from the original data frame. The idea here is that perhaps negative values occur more often in some parts of the year than other parts. However, the original data are formatted as character strings so we convert them to R’s <code>Date</code> format for easier manipulation.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(lubridate)
Loading required package:<span class="st"> </span>methods

Attaching package:<span class="st"> &#39;lubridate&#39;</span>
The following object is masked from <span class="st">&#39;package:base&#39;</span>:

<span class="st">    </span>date
&gt;<span class="st"> </span>negative &lt;-<span class="st"> </span><span class="kw">filter</span>(pm, year ==<span class="st"> &quot;2012&quot;</span>) %&gt;%<span class="st"> </span>
+<span class="st">         </span><span class="kw">mutate</span>(<span class="dt">negative =</span> PM &lt;<span class="st"> </span><span class="dv">0</span>, <span class="dt">date =</span> <span class="kw">ymd</span>(Date)) %&gt;%
+<span class="st">         </span><span class="kw">select</span>(date, negative)</code></pre>
<p>We can then extract the month from each of the dates with negative values and attempt to identify when negative values occur most often.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">mutate</span>(negative, <span class="dt">month =</span> <span class="kw">factor</span>(month.name[<span class="kw">month</span>(date)], <span class="dt">levels =</span> month.name)) %&gt;%
+<span class="st">         </span><span class="kw">group_by</span>(month) %&gt;%
+<span class="st">         </span><span class="kw">summarize</span>(<span class="dt">pct.negative =</span> <span class="kw">mean</span>(negative, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) *<span class="st"> </span><span class="dv">100</span>)
<span class="co"># A tibble: 10 × 2</span>
       month pct.negative
      &lt;fctr&gt;<span class="st">        </span><span class="er">&lt;</span>dbl&gt;
<span class="dv">1</span>    January     <span class="fl">2.970297</span>
<span class="dv">2</span>   February     <span class="fl">2.425408</span>
<span class="dv">3</span>      March     <span class="fl">2.408168</span>
<span class="dv">4</span>      April     <span class="fl">2.183876</span>
<span class="dv">5</span>        May     <span class="fl">1.726049</span>
<span class="dv">6</span>       June     <span class="fl">2.563424</span>
<span class="dv">7</span>       July     <span class="fl">0.791986</span>
<span class="dv">8</span>     August     <span class="fl">1.062328</span>
<span class="dv">9</span>  September     <span class="fl">1.519834</span>
<span class="dv">10</span>   October     <span class="fl">0.000000</span></code></pre>
<p>From the table above it appears that bulk of the negative values occur in the first four months of the year (January–April). However, beyond that simple observation, it is not clear why the negative values occur. That said, given the relatively low proportion of negative values, we will ignore them for now.</p>
</div>
<div id="changes-in-pm-levels-at-an-individual-monitor" class="section level3">
<h3><span class="header-section-number">16.3.2</span> Changes in PM levels at an individual monitor</h3>
<p>So far we have examined the change in PM levels on average across the country. One issue with the previous analysis is that the monitoring network could have changed in the time period between 1999 and 2012. So if for some reason in 2012 there are more monitors concentrated in cleaner parts of the country than there were in 1999, it might appear the PM levels decreased when in fact they didn’t. In this section we will focus on a single monitor in New York State to see if PM levels <em>at that monitor</em> decreased from 1999 to 2012.</p>
<p>Our first task is to identify a monitor in New York State that has data in 1999 and 2012 (not all monitors operated during both time periods). First we subset the data frames to only include data from New York (<code>State.Code == 36</code>) and only include the <code>County.Code</code> and the <code>Site.ID</code> (i.e. monitor number) variables.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>sites &lt;-<span class="st"> </span><span class="kw">filter</span>(pm, State.Code ==<span class="st"> </span><span class="dv">36</span>) %&gt;%<span class="st"> </span><span class="kw">select</span>(County.Code, Site.ID, year) %&gt;%<span class="st"> </span>unique</code></pre>
<p>Then we create a new variable that combines the county code and the site ID into a single string.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>sites &lt;-<span class="st"> </span><span class="kw">mutate</span>(sites, <span class="dt">site.code =</span> <span class="kw">paste</span>(County.Code, Site.ID, <span class="dt">sep =</span> <span class="st">&quot;.&quot;</span>))
&gt;<span class="st"> </span><span class="kw">str</span>(sites)
Classes <span class="st">&#39;tbl_df&#39;</span>, <span class="st">&#39;tbl&#39;</span> and <span class="st">&#39;data.frame&#39;</span>:<span class="st">   </span><span class="dv">51</span> obs. of  <span class="dv">4</span> variables:
<span class="st"> </span><span class="er">$</span><span class="st"> </span>County.Code:<span class="st"> </span>chr  <span class="st">&quot;001&quot;</span> <span class="st">&quot;001&quot;</span> <span class="st">&quot;005&quot;</span> <span class="st">&quot;005&quot;</span> ...
 $<span class="st"> </span>Site.ID    :<span class="st"> </span>chr  <span class="st">&quot;0005&quot;</span> <span class="st">&quot;0012&quot;</span> <span class="st">&quot;0073&quot;</span> <span class="st">&quot;0080&quot;</span> ...
 $<span class="st"> </span>year       :<span class="st"> </span>Factor w/<span class="st"> </span><span class="dv">2</span> levels <span class="st">&quot;1999&quot;</span>,<span class="st">&quot;2012&quot;</span>:<span class="st"> </span><span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...
 $<span class="st"> </span>site.code  :<span class="st"> </span>chr  <span class="st">&quot;001.0005&quot;</span> <span class="st">&quot;001.0012&quot;</span> <span class="st">&quot;005.0073&quot;</span> <span class="st">&quot;005.0080&quot;</span> ...</code></pre>
<p>Finally, we want the intersection between the sites present in 1999 and 2012 so that we might choose a monitor that has data in both periods.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>site.year &lt;-<span class="st"> </span><span class="kw">with</span>(sites, <span class="kw">split</span>(site.code, year))
&gt;<span class="st"> </span>both &lt;-<span class="st"> </span><span class="kw">intersect</span>(site.year[[<span class="dv">1</span>]], site.year[[<span class="dv">2</span>]])
&gt;<span class="st"> </span><span class="kw">print</span>(both)
 [<span class="dv">1</span>] <span class="st">&quot;001.0005&quot;</span> <span class="st">&quot;001.0012&quot;</span> <span class="st">&quot;005.0080&quot;</span> <span class="st">&quot;013.0011&quot;</span> <span class="st">&quot;029.0005&quot;</span> <span class="st">&quot;031.0003&quot;</span>
 [<span class="dv">7</span>] <span class="st">&quot;063.2008&quot;</span> <span class="st">&quot;067.1015&quot;</span> <span class="st">&quot;085.0055&quot;</span> <span class="st">&quot;101.0003&quot;</span></code></pre>
<p>Here (above) we can see that there are 10 monitors that were operating in both time periods. However, rather than choose one at random, it might best to choose one that had a reasonable amount of data in each year.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>count &lt;-<span class="st"> </span><span class="kw">mutate</span>(pm, <span class="dt">site.code =</span> <span class="kw">paste</span>(County.Code, Site.ID, <span class="dt">sep =</span> <span class="st">&quot;.&quot;</span>)) %&gt;%<span class="st"> </span>
+<span class="st">         </span><span class="kw">filter</span>(site.code %in%<span class="st"> </span>both)</code></pre>
<p>Now that we have subsetted the original data frames to only include the data from the monitors that overlap between 1999 and 2012, we can count the number of observations at each monitor to see which ones have the most observations.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">group_by</span>(count, site.code) %&gt;%<span class="st"> </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>())
<span class="co"># A tibble: 10 × 2</span>
   site.code     n
       &lt;chr&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;
<span class="dv">1</span>   <span class="fl">001.0005</span>   <span class="dv">186</span>
<span class="dv">2</span>   <span class="fl">001.0012</span>    <span class="dv">92</span>
<span class="dv">3</span>   <span class="fl">005.0080</span>    <span class="dv">92</span>
<span class="dv">4</span>   <span class="fl">013.0011</span>   <span class="dv">213</span>
<span class="dv">5</span>   <span class="fl">029.0005</span>    <span class="dv">94</span>
<span class="dv">6</span>   <span class="fl">031.0003</span>   <span class="dv">198</span>
<span class="dv">7</span>   <span class="fl">063.2008</span>   <span class="dv">152</span>
<span class="dv">8</span>   <span class="fl">067.1015</span>   <span class="dv">153</span>
<span class="dv">9</span>   <span class="fl">085.0055</span>    <span class="dv">38</span>
<span class="dv">10</span>  <span class="fl">101.0003</span>   <span class="dv">527</span></code></pre>
<p>A number of monitors seem suitable from the output, but we will focus here on County 63 and site ID 2008.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>pmsub &lt;-<span class="st"> </span><span class="kw">filter</span>(pm, State.Code ==<span class="st"> &quot;36&quot;</span> &amp;<span class="st"> </span>County.Code ==<span class="st"> &quot;063&quot;</span> &amp;<span class="st"> </span>Site.ID ==<span class="st"> &quot;2008&quot;</span>) %&gt;%
+<span class="st">         </span><span class="kw">select</span>(Date, year, PM) %&gt;%
+<span class="st">         </span><span class="kw">mutate</span>(<span class="dt">Date =</span> <span class="kw">ymd</span>(Date), <span class="dt">yday =</span> <span class="kw">yday</span>(Date))</code></pre>
<p>Now we plot the time series data of PM for the monitor in both years.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">qplot</span>(yday, PM, <span class="dt">data =</span> pmsub, <span class="dt">facets =</span> . ~<span class="st"> </span>year, <span class="dt">xlab =</span> <span class="st">&quot;Day of the year&quot;</span>)</code></pre>
<div class="figure"><span id="fig:unnamed-chunk-13"></span>
<img src="images/example-unnamed-chunk-13-1.png" alt="Daily PM for 1999 and 2012" width="768" />
<p class="caption">
Figure 16.2: Daily PM for 1999 and 2012
</p>
</div>
<p>From the plot above, we can that median levels of PM (horizontal solid line) have decreased a little from 10.45 in 1999 to 8.29 in 2012. However, perhaps more interesting is that the variation (spread) in the PM values in 2012 is much smaller than it was in 1999. This suggest that not only are median levels of PM lower in 2012, but that there are fewer large spikes from day to day. One issue with the data here is that the 1999 data are from July through December while the 2012 data are recorded in January through April. It would have been better if we’d had full-year data for both years as there could be some seasonal confounding going on.</p>
</div>
<div id="changes-in-state-wide-pm-levels" class="section level3">
<h3><span class="header-section-number">16.3.3</span> Changes in state-wide PM levels</h3>
<p>Although ambient air quality standards are set at the federal level in the U.S. and hence affect the entire country, the actual reduction and management of PM is left to the individual states. States that are not “in attainment” have to develop a plan to reduce PM so that that the are in attainment (eventually). Therefore, it might be useful to examine changes in PM at the state level. This analysis falls somewhere in between looking at the entire country all at once and looking at an individual monitor.</p>
<p>What we do here is calculate the mean of PM for each state in 1999 and 2012.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>mn &lt;-<span class="st"> </span><span class="kw">group_by</span>(pm, year, State.Code) %&gt;%<span class="st"> </span><span class="kw">summarize</span>(<span class="dt">PM =</span> <span class="kw">mean</span>(PM, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
&gt;<span class="st"> </span><span class="kw">head</span>(mn)
Source:<span class="st"> </span>local data frame [<span class="dv">6</span> x <span class="dv">3</span>]
Groups:<span class="st"> </span>year [<span class="dv">1</span>]

    year State.Code        PM
  &lt;fctr&gt;<span class="st">      </span><span class="er">&lt;</span>chr&gt;<span class="st">     </span><span class="er">&lt;</span>dbl&gt;
<span class="dv">1</span>   <span class="dv">1999</span>         <span class="dv">01</span> <span class="fl">19.956391</span>
<span class="dv">2</span>   <span class="dv">1999</span>         <span class="dv">02</span>  <span class="fl">6.665929</span>
<span class="dv">3</span>   <span class="dv">1999</span>         <span class="dv">04</span> <span class="fl">10.795547</span>
<span class="dv">4</span>   <span class="dv">1999</span>         <span class="dv">05</span> <span class="fl">15.676067</span>
<span class="dv">5</span>   <span class="dv">1999</span>         <span class="dv">06</span> <span class="fl">17.655412</span>
<span class="dv">6</span>   <span class="dv">1999</span>         <span class="dv">08</span>  <span class="fl">7.533304</span>
&gt;<span class="st"> </span><span class="kw">tail</span>(mn)
Source:<span class="st"> </span>local data frame [<span class="dv">6</span> x <span class="dv">3</span>]
Groups:<span class="st"> </span>year [<span class="dv">1</span>]

    year State.Code       PM
  &lt;fctr&gt;<span class="st">      </span><span class="er">&lt;</span>chr&gt;<span class="st">    </span><span class="er">&lt;</span>dbl&gt;
<span class="dv">1</span>   <span class="dv">2012</span>         <span class="dv">51</span> <span class="fl">8.708080</span>
<span class="dv">2</span>   <span class="dv">2012</span>         <span class="dv">53</span> <span class="fl">6.364667</span>
<span class="dv">3</span>   <span class="dv">2012</span>         <span class="dv">54</span> <span class="fl">9.821294</span>
<span class="dv">4</span>   <span class="dv">2012</span>         <span class="dv">55</span> <span class="fl">7.914545</span>
<span class="dv">5</span>   <span class="dv">2012</span>         <span class="dv">56</span> <span class="fl">4.005564</span>
<span class="dv">6</span>   <span class="dv">2012</span>         <span class="dv">72</span> <span class="fl">6.048045</span></code></pre>
<p>Now make a plot that shows the 1999 state-wide means in one “column” and the 2012 state-wide means in another columns. We then draw a line connecting the means for each year in the same state to highlight the trend.</p>
<pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">qplot</span>(xyear, PM, <span class="dt">data =</span> <span class="kw">mutate</span>(mn, <span class="dt">xyear =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(year))), 
+<span class="st">       </span><span class="dt">color =</span> <span class="kw">factor</span>(State.Code), 
+<span class="st">       </span><span class="dt">geom =</span> <span class="kw">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;line&quot;</span>))</code></pre>
<div class="figure"><span id="fig:unnamed-chunk-16"></span>
<img src="images/example-unnamed-chunk-16-1.png" alt="Change in mean PM levels from 1999 to 2012 by state" width="864" />
<p class="caption">
Figure 16.3: Change in mean PM levels from 1999 to 2012 by state
</p>
</div>
<p>This plot needs a bit of work still. But we can see that many states have decreased the average PM levels from 1999 to 2012 (although a few states actually increased their levels).</p>


</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-ggplot2-plotting-system-part-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="about-the-author.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rdpeng/exdata/edit/bookdown/example.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
